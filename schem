SELECT USERID, DATE(MODIFIEDDATE), COUNT (DISTINCT SESSIONID)
FROM events_data
WHERE CONTENT_TYPE = 'ABS-CBN SHOW - CURRENT'
GROUP BY USERID, DATE(MODIFIEDDATE)

L

mysql -u root events_db -ppwd@root -e \
"SELECT USERID, DATE(MODIFIEDDATE), EXTRACT(YEAR_MONTH FROM MIN(MODIFIEDDATE)), YEARWEEK(MIN(MODIFIEDDATE)), COUNT(DISTINCT SESSIONID) FROM events_data WHERE CONTENT_TYPE = 'ABS-CBN - Show - Current' AND USERID != '' AND IS_KNOWN = 1 AND USR_TOT_WATCHING_DUR > 0 AND USR_TOT_WATCHING_DUR != '' GROUP BY USERID, DATE(MODIFIEDDATE);" > freq_current.csv

mysql -u root events_db -ppwd@root -e \
"SELECT USERID, DATE(MODIFIEDDATE), EXTRACT(YEAR_MONTH FROM MIN(MODIFIEDDATE)), YEARWEEK(MIN(MODIFIEDDATE)), COUNT(DISTINCT SESSIONID) FROM events_data WHERE CONTENT_TYPE = 'ABS-CBN - Show - Old' AND USERID != '' AND IS_KNOWN = 1 AND USR_TOT_WATCHING_DUR > 0 AND USR_TOT_WATCHING_DUR != '' GROUP BY USERID, DATE(MODIFIEDDATE);" > freq_old.csv

mysql -u root events_db -ppwd@root -e \
"SELECT USERID, DATE(MODIFIEDDATE), EXTRACT(YEAR_MONTH FROM MIN(MODIFIEDDATE)), YEARWEEK(MIN(MODIFIEDDATE)), COUNT(DISTINCT SESSIONID) FROM events_data WHERE CONTENT_TYPE = 'Movie' AND USERID != '' AND IS_KNOWN = 1 AND USR_TOT_WATCHING_DUR > 0 AND USR_TOT_WATCHING_DUR != '' GROUP BY USERID, DATE(MODIFIEDDATE);" > freq_movie.csv

mysql -u root events_db -ppwd@root -e \
"SELECT USERID, DATE(MODIFIEDDATE), EXTRACT(YEAR_MONTH FROM MIN(MODIFIEDDATE)), YEARWEEK(MIN(MODIFIEDDATE)), COUNT(DISTINCT SESSIONID) FROM events_data WHERE CONTENT_TYPE = 'Original Movie' AND USERID != '' AND IS_KNOWN = 1 AND USR_TOT_WATCHING_DUR > 0 AND USR_TOT_WATCHING_DUR != '' GROUP BY USERID, DATE(MODIFIEDDATE);" > freq_origmovie.csv

mysql -u root events_db -ppwd@root -e \
"SELECT USERID, DATE(MODIFIEDDATE), EXTRACT(YEAR_MONTH FROM MIN(MODIFIEDDATE)), YEARWEEK(MIN(MODIFIEDDATE)), COUNT(DISTINCT SESSIONID) FROM events_data WHERE CONTENT_TYPE = 'Original Show' AND USERID != '' AND IS_KNOWN = 1 AND USR_TOT_WATCHING_DUR > 0 AND USR_TOT_WATCHING_DUR != '' GROUP BY USERID, DATE(MODIFIEDDATE);" > freq_origshow.csv

mysql -u root events_db -ppwd@root -e \
"SELECT USERID, DATE(MODIFIEDDATE), EXTRACT(YEAR_MONTH FROM MIN(MODIFIEDDATE)), YEARWEEK(MIN(MODIFIEDDATE)), COUNT(DISTINCT SESSIONID) FROM events_data WHERE CONTENT_TYPE = 'Fast Cut' AND USERID != '' AND IS_KNOWN = 1 AND USR_TOT_WATCHING_DUR > 0 AND USR_TOT_WATCHING_DUR != '' GROUP BY USERID, DATE(MODIFIEDDATE);" > freq_fastcut.csv

mysql -u root events_db -ppwd@root -e \
"SELECT USERID, DATE(MODIFIEDDATE), EXTRACT(YEAR_MONTH FROM MIN(MODIFIEDDATE)), YEARWEEK(MIN(MODIFIEDDATE)), COUNT(DISTINCT SESSIONID) FROM events_data WHERE CONTENT_TYPE = 'Live' AND USERID != '' AND IS_KNOWN = 1 AND USR_TOT_WATCHING_DUR > 0 AND USR_TOT_WATCHING_DUR != '' GROUP BY USERID, DATE(MODIFIEDDATE);" > freq_live.csv


mysql -u root events_db -ppwd@root -e \
"SELECT USERID, SESSIONID, DATE(MIN(MODIFIEDDATE)), EXTRACT(YEAR_MONTH FROM MIN(MODIFIEDDATE)), YEARWEEK(MIN(MODIFIEDDATE)), TIMESTAMPDIFF(MINUTE, MIN(SESSION_STARTDT), MAX(SESSION_ENDDT))  FROM events_data WHERE CONTENT_TYPE = 'ABS-CBN - Show - Current' AND USERID != '' AND IS_KNOWN = 1 AND USR_TOT_WATCHING_DUR > 0 AND USR_TOT_WATCHING_DUR != '' GROUP BY USERID, SESSIONID;" > eng_current.csv

mysql -u root events_db -ppwd@root -e \
"SELECT USERID, SESSIONID, DATE(MIN(MODIFIEDDATE)), EXTRACT(YEAR_MONTH FROM MIN(MODIFIEDDATE)), YEARWEEK(MIN(MODIFIEDDATE)), TIMESTAMPDIFF(MINUTE, MIN(SESSION_STARTDT), MAX(SESSION_ENDDT)) FROM events_data WHERE CONTENT_TYPE = 'ABS-CBN - Show - Old' AND USERID != '' AND IS_KNOWN = 1 AND USR_TOT_WATCHING_DUR > 0 AND USR_TOT_WATCHING_DUR != '' GROUP BY USERID, SESSIONID;" > eng_old.csv

mysql -u root events_db -ppwd@root -e \
"SELECT USERID, SESSIONID, DATE(MIN(MODIFIEDDATE)), EXTRACT(YEAR_MONTH FROM MIN(MODIFIEDDATE)), YEARWEEK(MIN(MODIFIEDDATE)), TIMESTAMPDIFF(MINUTE, MIN(SESSION_STARTDT), MAX(SESSION_ENDDT)) FROM events_data WHERE CONTENT_TYPE = 'Movie' AND USERID != '' AND IS_KNOWN = 1 AND USR_TOT_WATCHING_DUR > 0 AND USR_TOT_WATCHING_DUR != '' GROUP BY USERID, SESSIONID;" > eng_movie.csv

mysql -u root events_db -ppwd@root -e \
"SELECT USERID, SESSIONID, DATE(MIN(MODIFIEDDATE)), EXTRACT(YEAR_MONTH FROM MIN(MODIFIEDDATE)), YEARWEEK(MIN(MODIFIEDDATE)), TIMESTAMPDIFF(MINUTE, MIN(SESSION_STARTDT), MAX(SESSION_ENDDT)) FROM events_data WHERE CONTENT_TYPE = 'Original Movie' AND USERID != '' AND IS_KNOWN = 1 AND USR_TOT_WATCHING_DUR > 0 AND USR_TOT_WATCHING_DUR != '' GROUP BY USERID, SESSIONID;" > eng_origmovie.csv

mysql -u root events_db -ppwd@root -e \
"SELECT USERID, SESSIONID, DATE(MIN(MODIFIEDDATE)), EXTRACT(YEAR_MONTH FROM MIN(MODIFIEDDATE)), YEARWEEK(MIN(MODIFIEDDATE)), TIMESTAMPDIFF(MINUTE, MIN(SESSION_STARTDT), MAX(SESSION_ENDDT)) FROM events_data WHERE CONTENT_TYPE = 'Original Show' AND USERID != '' AND IS_KNOWN = 1 AND USR_TOT_WATCHING_DUR > 0 AND USR_TOT_WATCHING_DUR != '' GROUP BY USERID, SESSIONID;" > eng_origshow.csv

mysql -u root events_db -ppwd@root -e \
"SELECT USERID, SESSIONID, DATE(MIN(MODIFIEDDATE)), EXTRACT(YEAR_MONTH FROM MIN(MODIFIEDDATE)), YEARWEEK(MIN(MODIFIEDDATE)), TIMESTAMPDIFF(MINUTE, MIN(SESSION_STARTDT), MAX(SESSION_ENDDT)) FROM events_data WHERE CONTENT_TYPE = 'Fast Cut' AND USERID != '' AND IS_KNOWN = 1 AND USR_TOT_WATCHING_DUR > 0 AND USR_TOT_WATCHING_DUR != '' GROUP BY USERID, SESSIONID;" > eng_fastcut.csv

mysql -u root events_db -ppwd@root -e \
"SELECT USERID, SESSIONID, DATE(MIN(MODIFIEDDATE)), EXTRACT(YEAR_MONTH FROM MIN(MODIFIEDDATE)), YEARWEEK(MIN(MODIFIEDDATE)), TIMESTAMPDIFF(MINUTE, MIN(SESSION_STARTDT), MAX(SESSION_ENDDT)) FROM events_data WHERE CONTENT_TYPE = 'Live' AND USERID != '' AND IS_KNOWN = 1 AND USR_TOT_WATCHING_DUR > 0 AND USR_TOT_WATCHING_DUR != '' GROUP BY USERID, SESSIONID;" > eng_live.csv

SELECT USERID, SESSIONID, DAYOFWEEK(MIN(MODIFIEDDATE)), DATE(MIN(MODIFIEDDATE)), EXTRACT(YEAR_MONTH FROM MIN(MODIFIEDDATE)), YEARWEEK(MIN(MODIFIEDDATE)) FROM events_data WHERE CONTENT_TYPE = 'Live' AND USERID != '' AND IS_KNOWN = 1 AND USR_TOT_WATCHING_DUR > 0 AND USR_TOT_WATCHING_DUR != '' GROUP BY USERID, DATE(MODIFIEDDATE);

SELECT USERID, DATE(MODIFIEDDATE), DAYOFWEEK(MIN(MODIFIEDDATE)) FROM events_data WHERE CONTENT_TYPE = 'LIVE' AND USERID != '' AND IS_KNOWN = 1 AND USR_TOT_WATCHING_DUR > 0 AND USR_TOT_WATCHING_DUR != '' GROUP BY USERID, DATE(MODIFIEDDATE) LIMIT 5 \G;

mysql -u root events_db -ppwd@root -e \
"SELECT USERID, DATE(MODIFIEDDATE), DAYOFWEEK(MIN(MODIFIEDDATE)) FROM events_data WHERE CONTENT_TYPE = 'ABS-CBN - Show - Current' AND USERID != '' AND IS_KNOWN = 1 AND USR_TOT_WATCHING_DUR > 0 AND USR_TOT_WATCHING_DUR != '' GROUP BY USERID, DATE(MODIFIEDDATE);" > reg_current.csv

mysql -u root events_db -ppwd@root -e \
"SELECT USERID, DATE(MODIFIEDDATE), DAYOFWEEK(MIN(MODIFIEDDATE)) FROM events_data WHERE CONTENT_TYPE = 'ABS-CBN - Show - Old' AND USERID != '' AND IS_KNOWN = 1 AND USR_TOT_WATCHING_DUR > 0 AND USR_TOT_WATCHING_DUR != '' GROUP BY USERID, DATE(MODIFIEDDATE);" > reg_old.csv

mysql -u root events_db -ppwd@root -e \
"SELECT USERID, DATE(MODIFIEDDATE), DAYOFWEEK(MIN(MODIFIEDDATE)) FROM events_data WHERE CONTENT_TYPE = 'Movie' AND USERID != '' AND IS_KNOWN = 1 AND USR_TOT_WATCHING_DUR > 0 AND USR_TOT_WATCHING_DUR != '' GROUP BY USERID, DATE(MODIFIEDDATE);" > reg_movie.csv

mysql -u root events_db -ppwd@root -e \
"SELECT USERID, DATE(MODIFIEDDATE), DAYOFWEEK(MIN(MODIFIEDDATE)) FROM events_data WHERE CONTENT_TYPE = 'Original Movie' AND USERID != '' AND IS_KNOWN = 1 AND USR_TOT_WATCHING_DUR > 0 AND USR_TOT_WATCHING_DUR != '' GROUP BY USERID, DATE(MODIFIEDDATE);" > reg_origmovie.csv

mysql -u root events_db -ppwd@root -e \
"SELECT USERID, DATE(MODIFIEDDATE), DAYOFWEEK(MIN(MODIFIEDDATE)) FROM events_data WHERE CONTENT_TYPE = 'Original Show' AND USERID != '' AND IS_KNOWN = 1 AND USR_TOT_WATCHING_DUR > 0 AND USR_TOT_WATCHING_DUR != '' GROUP BY USERID, DATE(MODIFIEDDATE);" > reg_origshow.csv

mysql -u root events_db -ppwd@root -e \
"SELECT USERID, DATE(MODIFIEDDATE), DAYOFWEEK(MIN(MODIFIEDDATE)) FROM events_data WHERE CONTENT_TYPE = 'Fast Cut' AND USERID != '' AND IS_KNOWN = 1 AND USR_TOT_WATCHING_DUR > 0 AND USR_TOT_WATCHING_DUR != '' GROUP BY USERID, DATE(MODIFIEDDATE);" > reg_fastcut.csv

mysql -u root events_db -ppwd@root -e \
"SELECT USERID, DATE(MODIFIEDDATE), DAYOFWEEK(MIN(MODIFIEDDATE)) FROM events_data WHERE CONTENT_TYPE = 'Live' AND USERID != '' AND IS_KNOWN = 1 AND USR_TOT_WATCHING_DUR > 0 AND USR_TOT_WATCHING_DUR != '' GROUP BY USERID, DATE(MODIFIEDDATE);" > reg_live.csv
