SELECT USERID, SESSIONID, MIN(EXTRACT(YEAR_MONTH FROM SESSION_STARTDT)),
MIN(YEARWEEK(SESSION_STARTDT)),
MIN(DATE(SESSION_STARTDT)),
MIN(DAYOFWEEK(SESSION_STARTDT))
FROM events_data_new
GROUP BY USERID, SESSIONID
INTO OUTFILE '/var/lib/mysql-files/regularity.csv'
FIELDS TERMINATED BY ','
LINES TERMINATED BY '\n'