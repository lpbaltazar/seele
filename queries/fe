SELECT USERID,
DATE(SESSION_STARTDT),
COUNT(DISTINCT SESSIONID),
COUNT(SESSIONID),
TIMESTAMPDIFF(MINUTE, MIN(SESSION_STARTDT), MAX(SESSION_ENDDT)),
SUM(USR_TOT_WATCHING_DUR)
FROM events_data
GROUP BY USERID, DATE(SESSION_STARTDT)
INTO OUTFILE "/var/lib/mysql-files/new_freq.csv"
FIELDS TERMINATED BY ','
LINES TERMINATED BY '\n'
